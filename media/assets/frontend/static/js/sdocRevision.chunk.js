(this["webpackJsonpseahub-frontend"]=this["webpackJsonpseahub-frontend"]||[]).push([[18],{1751:function(e,n,t){t(72),e.exports=t(1752)},1752:function(e,n,t){"use strict";t.r(n);var i=t(3),o=t(5),s=t(6),a=t(7),c=t(2),r=t.n(c),d=t(34),l=t.n(d),u=t(31),h=t.n(u),f=t(78),v=t(147),j=t(1),b=t(22),g=t(387),p=t(4),m=t(8),O=(t(188),t(1753),t(9)),x=t(0),w=window.app.config,k=w.serviceURL,C=w.avatarURL,N=w.siteRoot,L=window.app.pageOptions,y=L.username,M=L.name,R=window.sdocRevision,P=R.repoID,U=R.fileName,E=R.filePath,D=R.docUuid,I=R.assetsUrl,S=R.fileDownloadLink,B=R.originFileDownloadLink;window.seafile={repoID:P,docPath:E,docName:U,docUuid:D,isOpenSocket:!1,serviceUrl:k,name:M,username:y,avatarURL:C,siteRoot:N,assetsUrl:I};var F=function(e){Object(s.a)(t,e);var n=Object(a.a)(t);function t(e){var o;return Object(i.a)(this,t),(o=n.call(this,e)).edit=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),window.location.href="".concat(N,"lib/").concat(P,"/file").concat(E)},o.publishRevision=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),m.a.sdocPublishRevision(D).then((function(e){var n=e.data.origin_file_path;window.location.href="".concat(N,"lib/").concat(P,"/file").concat(n)})).catch((function(e){var n=p.a.getErrorMsg(e,!1);O.a.danger(Object(j.ub)(n))}))},o.renderContent=function(){var e=o.state,n=e.isLoading,t=e.errorMessage,i=e.revisionContent,s=e.originContent;return n?Object(x.jsx)("div",{className:"sdoc-revision-viewer h-100 d-flex align-items-center justify-content-center",children:Object(x.jsx)(b.a,{})}):t?Object(x.jsx)("div",{className:"sdoc-revision-viewer h-100 d-flex align-items-center justify-content-center",children:Object(j.ub)(t)}):Object(x.jsx)(v.a,{currentContent:i,lastContent:s})},o.state={isLoading:!0,errorMessage:"",revisionContent:"",originContent:""},o}return Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch(S).then((function(e){return e.json()})).then((function(n){fetch(B).then((function(e){return e.json()})).then((function(t){e.setState({revisionContent:n,originContent:t,isLoading:!1,errorMessage:""})})).catch((function(n){var t=p.a.getErrorMsg(n,!0);e.setState({isLoading:!1,errorMessage:t})}))})).catch((function(n){var t=p.a.getErrorMsg(n,!0);e.setState({isLoading:!1,errorMessage:t})}))}},{key:"render",value:function(){var e=this.state,n=e.isLoading,t=e.errorMessage;return Object(x.jsx)("div",{className:"sdoc-revision d-flex h-100 w-100 o-hidden",children:Object(x.jsxs)("div",{className:"sdoc-revision-container d-flex flex-column",children:[Object(x.jsxs)("div",{className:"sdoc-revision-header pl-4 pr-4 d-flex justify-content-between w-100 o-hidden",children:[Object(x.jsxs)("div",{className:h()("sdoc-revision-header-left h-100 d-flex align-items-center o-hidden"),children:[Object(x.jsx)(g.a,{}),Object(x.jsx)("div",{className:"file-name text-truncate",children:U})]}),Object(x.jsx)("div",{className:"sdoc-revision-header-right h-100 d-flex align-items-center",children:!n&&!t&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(f.a,{color:"success",className:"mr-4",onClick:this.edit,children:Object(j.ub)("Edit")}),Object(x.jsx)(f.a,{color:"success",onClick:this.publishRevision,children:Object(j.ub)("Publish")})]})})]}),Object(x.jsx)("div",{className:"sdoc-revision-content f-flex",children:this.renderContent()})]})})}}]),t}(r.a.Component);l.a.render(Object(x.jsx)(F,{}),document.getElementById("wrapper"))},1753:function(e,n,t){},387:function(e,n,t){"use strict";var i=t(3),o=t(5),s=t(6),a=t(7),c=t(2),r=(t(567),t(0)),d=function(e){Object(s.a)(t,e);var n=Object(a.a)(t);function t(){var e;Object(i.a)(this,t);for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return(e=n.call.apply(n,[this].concat(s))).onBackClick=function(e){e.preventDefault(),window.history.back()},e}return Object(o.a)(t,[{key:"render",value:function(){return Object(r.jsx)("div",{className:"go-back",onClick:this.onBackClick,children:Object(r.jsx)("span",{className:"fas fa-chevron-left"})})}}]),t}(c.Component);n.a=d},567:function(e,n,t){}},[[1751,1,0]]]);
//# sourceMappingURL=sdocRevision.chunk.js.map